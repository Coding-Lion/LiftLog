@page "/manage-workouts"
@inherits Fluxor.Blazor.Web.Components.FluxorComponent
@using Fluxor
@using LiftLog.WebUi.Store.Program
@inject IState<ProgramState> ProgramState
@inject NavigationManager NavigationManager
@inject IDispatcher Dispatcher

<div class="flex">
    <button @onclick="BackToSettings" class="m-1">&lt;</button><h3>Manage Workouts</h3>
</div>
@foreach (var session in ProgramState.Value.SessionBlueprints)
{
    <Card>
        <span class="text-xl">@session.Name</span>
        <button @onclick=@(()=>MoveSessionUp(session)) class="bg-slate-300 m-1">^</button>
        <button @onclick=@(()=>MoveSessionDown(session)) class="bg-slate-300 m-1">V</button>
        @foreach (var exercise in session.Exercises)
        {
            <div class="flex justify-between w-full">
                <span>@exercise.Name</span>
                <span> @exercise.Sets x @exercise.RepsPerSet</span>
            </div>
        }
    </Card>
}

@code {

    void MoveSessionUp(SessionBlueprint sessionBlueprint)
    {
        Dispatcher.Dispatch(new MoveSessionBlueprintUpInProgramAction(sessionBlueprint));
    }
    
    void MoveSessionDown(SessionBlueprint sessionBlueprint)
    {
        Dispatcher.Dispatch(new MoveSessionBlueprintDownInProgramAction(sessionBlueprint));
    }

    void BackToSettings()
    {
        NavigationManager.NavigateTo("/settings");
    }
}